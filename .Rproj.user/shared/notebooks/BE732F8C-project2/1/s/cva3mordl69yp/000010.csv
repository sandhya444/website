"0",""
"0","#logistic regression"
"0","statesfit1 <- glm(y ~ gdp + women, data = states1, family = ""binomial"")"
"0","coeftest(statesfit1)"
"1","
z test of coefficients:

"
"1","           "
"1","    Estimate"
"1","  Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","   "
"1","
(Intercept)"
"1","  9.2171e+00"
"1","  3.3088e+00"
"1","  2.7857"
"1"," 0.005342"
"1"," **"
"1","
gdp        "
"1"," -6.8616e-07"
"1","  6.8461e-07"
"1"," -1.0023"
"1"," 0.316214"
"1","   "
"1","
women      "
"1"," -1.0313e-02"
"1","  4.1549e-03"
"1"," -2.4823"
"1"," 0.013055"
"1"," * "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"0","exp(coef(statesfit1))"
"1"," (Intercept) "
"1","         gdp "
"1","       women "
"1","
"
"1","1.006800e+04 "
"1","9.999993e-01 "
"1","9.897395e-01 "
"1","
"
"0","#confusion matrix"
"0","prob_glm <- predict(statesfit1, data = states1, type = ""response"")"
"0","table(predict = as.numeric(prob_glm>0.5), truth =states1$y) %>% addmargins"
"1","       truth
"
"1","predict"
"1","  0"
"1","  1"
"1"," Sum"
"1","
    0  "
"1","  8"
"1","  3"
"1","  11"
"1","
    1  "
"1","  9"
"1"," 31"
"1","  40"
"1","
    Sum"
"1"," 17"
"1"," 34"
"1","  51"
"1","
"
"0","#accuracy"
"0","accuracy <- (8+31)/51"
"0","accuracy"
"1","[1]"
"1"," 0.7647059"
"1","
"
"0","#TPR"
"0","sensitivity <- 31/34"
"0","sensitivity"
"1","[1]"
"1"," 0.9117647"
"1","
"
"0","#TNR"
"0","specificity <- 8/17"
"0","specificity"
"1","[1]"
"1"," 0.4705882"
"1","
"
"0","#PPV"
"0","PPV <- 31/40"
"0","PPV"
"1","[1]"
"1"," 0.775"
"1","
"
"0","#ROC and AUC"
"0","library(plotROC)"
"0","states1$prob1 <- predict(statesfit1, data = states1, type=""response"")"
"0","ROCplot<-ggplot(states1)+geom_roc(aes(d=y, m=prob1), n.cuts=0) "
"0","ROCplot"
